/**
 * @license almond 0.2.9 Copyright (c) 2011-2014, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */

!function(t,e){t.hoopty=e()}(this,function(){var t,e,n;return function(i){function o(t,e){return b.call(t,e)}function s(t,e){var n,i,o,s,r,h,p,c,l,u,a,y=e&&e.split("/"),d=v.map,f=d&&d["*"]||{};if(t&&"."===t.charAt(0))if(e){for(y=y.slice(0,y.length-1),t=t.split("/"),r=t.length-1,v.nodeIdCompat&&A.test(t[r])&&(t[r]=t[r].replace(A,"")),t=y.concat(t),l=0;l<t.length;l+=1)if(a=t[l],"."===a)t.splice(l,1),l-=1;else if(".."===a){if(1===l&&(".."===t[2]||".."===t[0]))break;l>0&&(t.splice(l-1,2),l-=2)}t=t.join("/")}else 0===t.indexOf("./")&&(t=t.substring(2));if((y||f)&&d){for(n=t.split("/"),l=n.length;l>0;l-=1){if(i=n.slice(0,l).join("/"),y)for(u=y.length;u>0;u-=1)if(o=d[y.slice(0,u).join("/")],o&&(o=o[i])){s=o,h=l;break}if(s)break;!p&&f&&f[i]&&(p=f[i],c=l)}!s&&p&&(s=p,h=c),s&&(n.splice(0,h,s),t=n.join("/"))}return t}function r(t,e){return function(){return y.apply(i,w.call(arguments,0).concat([t,e]))}}function h(t){return function(e){return s(e,t)}}function p(t){return function(e){g[t]=e}}function c(t){if(o(m,t)){var e=m[t];delete m[t],x[t]=!0,a.apply(i,e)}if(!o(g,t)&&!o(x,t))throw new Error("No "+t);return g[t]}function l(t){var e,n=t?t.indexOf("!"):-1;return n>-1&&(e=t.substring(0,n),t=t.substring(n+1,t.length)),[e,t]}function u(t){return function(){return v&&v.config&&v.config[t]||{}}}var a,y,d,f,g={},m={},v={},x={},b=Object.prototype.hasOwnProperty,w=[].slice,A=/\.js$/;d=function(t,e){var n,i=l(t),o=i[0];return t=i[1],o&&(o=s(o,e),n=c(o)),o?t=n&&n.normalize?n.normalize(t,h(e)):s(t,e):(t=s(t,e),i=l(t),o=i[0],t=i[1],o&&(n=c(o))),{f:o?o+"!"+t:t,n:t,pr:o,p:n}},f={require:function(t){return r(t)},exports:function(t){var e=g[t];return"undefined"!=typeof e?e:g[t]={}},module:function(t){return{id:t,uri:"",exports:g[t],config:u(t)}}},a=function(t,e,n,s){var h,l,u,a,y,v,b=[],w=typeof n;if(s=s||t,"undefined"===w||"function"===w){for(e=!e.length&&n.length?["require","exports","module"]:e,y=0;y<e.length;y+=1)if(a=d(e[y],s),l=a.f,"require"===l)b[y]=f.require(t);else if("exports"===l)b[y]=f.exports(t),v=!0;else if("module"===l)h=b[y]=f.module(t);else if(o(g,l)||o(m,l)||o(x,l))b[y]=c(l);else{if(!a.p)throw new Error(t+" missing "+l);a.p.load(a.n,r(s,!0),p(l),{}),b[y]=g[l]}u=n?n.apply(g[t],b):void 0,t&&(h&&h.exports!==i&&h.exports!==g[t]?g[t]=h.exports:u===i&&v||(g[t]=u))}else t&&(g[t]=n)},t=e=y=function(t,e,n,o,s){if("string"==typeof t)return f[t]?f[t](e):c(d(t,e).f);if(!t.splice){if(v=t,v.deps&&y(v.deps,v.callback),!e)return;e.splice?(t=e,e=n,n=null):t=i}return e=e||function(){},"function"==typeof n&&(n=o,o=s),o?a(i,t,e,n):setTimeout(function(){a(i,t,e,n)},4),y},y.config=function(t){return y(t)},t._defined=g,n=function(t,e,n){e.splice||(n=e,e=[]),o(g,t)||o(m,t)||(m[t]=[t,e,n])},n.amd={jQuery:!0}}(),n("../bower_components/almond/almond",function(){}),n("extendable",[],function(){return function(){function t(){}return t.extend=function(t){function e(){this.constructor=t}for(var n in this)t.prototype.hasOwnProperty(n)||(t[n]=this[n]);e.prototype=this.prototype,t.prototype=new e,t.__super__=this.prototype},t}()}),n("scene",["extendable"],function(t){return function(){function e(t){this.engine=t,this.entities=[]}return t.extend(e),e.prototype.route="/",e.prototype.entities=[],e.prototype.engine=null,e.prototype.dragging=!1,e.prototype.render=function(t,e){this.ctx=t;var n=this;this.entities.forEach(function(i){i.display&&(n.eventFire({type:"preRender",dt:e}),i.render(t,e))})},e.prototype.entityAdd=function(t){return this.entities.push(t),this.entities[this.entities.length-1]},e.prototype.entityRemove=function(t){for(var e in this.entities){var n=this.entities[e];if(n===t)return this.entities.splice(e,1),!0}return!1},e.prototype.eventFire=function(t){t.type in this&&this[t.type](t);for(var e=this.entities.length-1;e>=0;e--){var n=this.entities[e];t.type in n&&n[t.type](t,this);for(var i in n.components){var o=n.components[i];t.type in o&&o[t.type](t,this)}}},e.prototype.getEventCoords=function(t){if("ctx"in this){var e=0,n=0,i=0,o=0,s=this.ctx.canvas,r=0,h=0;if("touchstart"===t.type||"touchmove"===t.type||"touchend"===t.type||"touchcancel"===t.type){var p=t.touches[0]||t.changedTouches[0];r=p.pageX,h=p.pageY}else r=t.pageX,h=t.pageY;do e+=s.offsetLeft-s.scrollLeft,n+=s.offsetTop-s.scrollTop;while(s=s.offsetParent);i=r-e,o=h-n;var c=this.ctx.canvas.width/this.ctx.canvas.style.width.substr(0,this.ctx.canvas.style.width.length-2);return i*=c,o*=c,{x:i,y:o}}return{x:0,y:0}},e.isInside=function(t,e){return t.x>=e.x&&t.x<=e.x+e.width&&t.y>=e.y&&t.y<=e.y+e.height?!0:!1},e.isOverlap=function(t,e){var n=t.x,i=t.x+t.width,o=t.y,s=t.y+t.height,r=e.x,h=e.x+e.width,p=e.y,c=e.y+e.height;return h>n&&i>r&&c>o&&s>p?!0:!1},e.getMidpoint=function(t,e){var n={x:0,y:0};return n.x=Math.round((t.x+e.x)/2),n.y=Math.round((t.y+e.y)/2),n},e.prototype.reset=function(){this.engine.scenes[this.name]=new e(this.engine),this.engine.changeScenes(this.name)},e.prototype.destroy=function(){this.engine.sceneDestroy(this.name)},e}()}),n("engine",["scene"],function(){return function(){function t(e,n){"undefined"!=typeof n&&null!==n&&(this.changeScenesCallback=n),t.prototype.scenes={},this.canvas=e,this.ctx=this.canvas.getContext("2d");var i=this;this.canvas.addEventListener("mousedown",function(t){i.getSceneActive().eventFire(t)}),this.canvas.addEventListener("mousemove",function(t){i.getSceneActive().eventFire(t)}),this.canvas.addEventListener("mouseup",function(t){i.getSceneActive().eventFire(t)}),this.canvas.addEventListener("click",function(t){i.getSceneActive().eventFire(t)}),this.canvas.addEventListener("touchstart",function(t){i.getSceneActive().eventFire(t)}),this.canvas.addEventListener("touchmove",function(t){i.getSceneActive().eventFire(t)}),this.canvas.addEventListener("touchend",function(t){i.getSceneActive().eventFire(t)}),document.addEventListener("keyup",function(t){i.getSceneActive().eventFire(t)}),document.addEventListener("keydown",function(t){i.getSceneActive().eventFire(t)})}return t.prototype.canvas=null,t.prototype.ctx=null,t.prototype.scenes={},t.prototype.sceneActive=null,t.prototype.changeScenesCallback=null,t.prototype.sceneChanging=!1,t.prototype.render=function(t){this.getSceneActive().render(this.ctx,t)},t.prototype.sceneAdd=function(t,e){this.scenes[e]=t,this.scenes[e].name=e},t.prototype.sceneDestroy=function(t){delete this.scenes[t]},t.prototype.getSceneActive=function(){return this.scenes[this.sceneActive]},t.prototype.changeScenes=function(t,e,n){if(null!==t&&t!==this.sceneActive&&!this.sceneChanging){var i=this.sceneActive;if(this.scenes.hasOwnProperty(t)||null===e||this.sceneAdd(new e(this),t),this.scenes.hasOwnProperty(t)){this.sceneChanging=!0;var o=this;window.setTimeout(function(){o.sceneActive=t,null!==n&&n||null===i||o.scenes[i].destroy(),null!==o.changeScenesCallback&&o.changeScenesCallback(o.getSceneActive()),o.sceneChanging=!1},50)}}},t}()}),n("entity",["extendable"],function(t){return function(){function e(t,e,n,i,o){this.x=t,this.y=e,this.width=n,this.height=i,null!==o&&(this.color=o),this.components={}}return t.extend(e),e.prototype.display=!0,e.prototype.x=0,e.prototype.y=0,e.prototype.width=0,e.prototype.height=0,e.prototype.color="rgb(0, 0, 0)",e.prototype.components={},e.prototype.render=function(t){t.fillStyle=this.color,t.fillRect(this.x,this.y,this.width,this.height)},e.prototype.componentAdd=function(t){this.components[t.name]=t},e.prototype.componentRemove=function(t){delete this.components[t.name]},e}()}),n("sprite",["entity"],function(t){return function(){function e(t,n,i,o,s,r,h,p,c){e.__super__.constructor.call(this,t,n,i,o),this.spriteSheet=s,this.spriteX="undefined"==typeof r||null===r?0:r,this.spriteY="undefined"==typeof h||null===h?0:h,this.spriteWidth="undefined"==typeof p||null===p?i:p,this.spriteHeight="undefined"==typeof c||null===c?o:c,this.spriteXDefault=this.spriteX,this.spriteYDefault=this.spriteY,this.obj=new Image;var l=this;this.obj.addEventListener("load",function(){l.loading=!1},!1),this.obj.src=this.spriteSheet,this.loading=!0,this.spriteAnimations={}}return t.extend(e),e.prototype.obj=null,e.prototype.spriteSheet=null,e.prototype.spriteX=0,e.prototype.spriteY=0,e.prototype.spriteXDefault=0,e.prototype.spriteYDefault=0,e.prototype.loading=!1,e.prototype.spriteAnimations={},e.prototype.spriteAnimation=null,e.prototype.spriteAnimationTime=null,e.prototype.spriteAnimationCallback=null,e.prototype.render=function(t,e){if(!this.loading){if(null!==this.spriteAnimation){this.spriteAnimationTime+=e;var n=this.spriteAnimations[this.spriteAnimation],i=n.toX-n.fromX+1;if(this.spriteAnimationTime>n.period*i)this.spriteAnimationRepetitions>0?(this.spriteAnimationRepetitions--,0===this.spriteAnimationRepetitions?(null!==this.spriteAnimationCallback&&this.spriteAnimationCallback({type:"spriteAnimationEnd"},this),this.spriteAnimation=null,this.spriteAnimationTime=null,this.spriteAnimationCallback=null,this.spriteX=this.spriteXDefault,this.spriteY=this.spriteYDefault):this.spriteAnimationTime=0):this.spriteAnimationTime=0;else{var o=Math.floor(this.spriteAnimationTime/n.period);this.spriteX=n.fromX+o,this.spriteY=n.fromY}}if(this.display){var s=this.obj,r=this.spriteX*this.spriteWidth,h=this.spriteY*this.spriteHeight,p=this.spriteWidth,c=this.spriteHeight,l=this.x,u=this.y,a=this.width,y=this.height;t.drawImage(s,r,h,p,c,l,u,a,y)}}},e.prototype.spriteAnimationAdd=function(t,e,n,i,o){this.spriteAnimations[t]={fromX:e,fromY:n,toX:i,period:o}},e.prototype.spriteAnimate=function(t,e,n){"undefined"!=typeof n&&(this.spriteAnimationCallback=n),null===e&&(e=-1),this.spriteAnimationRepetitions=e,this.spriteAnimation=t,this.spriteAnimationTime=0},e.prototype.spriteAnimateStop=function(){this.spriteAnimation=null,this.spriteAnimationTime=null,this.spriteX=this.spriteXDefault,this.spriteY=this.spriteYDefault},e}()}),n("text",["entity"],function(t){return function(){function e(t,n,i,o,s,r){"undefined"!=typeof o&&(this.text=o),"undefined"!=typeof s&&(this.font=s),"undefined"!=typeof r&&(this.fillStyle=r),e.__super__.constructor.call(this,t,n,i,0)}return t.extend(e),e.prototype.text="",e.prototype.font=null,e.prototype.fillStyle="rgb(0, 0, 0)",e.prototype.render=function(t){null!==this.font&&(t.font=this.font),t.fillStyle=this.fillStyle,t.fillText(this.text,this.x,this.y,this.width)},e}()}),n("textMultiline",["text"],function(t){return function(){function e(t,n,i,o,s,r,h,p){e.__super__.constructor.call(this,t,n,i,o,s,r),"undefined"!=typeof h&&(this.charsPerLine=h),"undefined"!=typeof p&&(this.lineHeight=p);for(var c=this.text.split(" "),l=0;c.length;){for(this.textArray[l]=c.shift();this.textArray[l]&&"undefined"!=typeof c[0]&&(this.textArray[l]+c[0]).length<this.charsPerLine;)this.textArray[l]+=" "+c.shift();l++}}return t.extend(e),e.prototype.charsPerLine=80,e.prototype.lineHeight=30,e.prototype.textArray=[],e.prototype.render=function(t){null!==this.font&&(t.font=this.font),t.fillStyle=this.fillStyle;for(var e=0;e<this.textArray.length;e++)t.fillText(this.textArray[e],this.x,this.y+e*this.lineHeight,this.width)},e}()}),n("button",["scene","text"],function(t,e){return function(){function n(t,e,i,o,s,r,h,p,c,l){n.__super__.constructor.call(this,t,e,i,s,r,h),this.callback=p,this.height=o,"undefined"!=typeof c&&(this.padding=c),"undefined"!=typeof l&&(this.strokeStyle=l)}return e.extend(n),n.prototype.callback=null,n.prototype.scene=null,n.prototype.height=null,n.prototype.padding=16,n.prototype.strokeStyle="rgb(0, 0, 0)",n.prototype.render=function(t){t.strokeStyle=this.strokeStyle,t.strokeRect(this.x,this.y,this.width,this.height),null!==this.font&&(t.font=this.font),t.fillStyle=this.fillStyle,t.fillText(this.text,this.x+this.padding,this.y+2*this.height/3,this.width-2*this.padding)},n.prototype.click=function(e,n){t.isInside(n.getEventCoords(e),this)&&this.display&&this.callback(e)},n}()}),n("component",["extendable"],function(t){return function(){function e(t){this.entity=t}return t.extend(e),e.prototype.entity={},e.prototype.name="Component",e.prototype.respondEvents={},e}()}),n("tween",["component"],function(t){return function(){function e(t,n,i,o,s){this.x=n,this.y=i,"undefined"!=typeof s&&(this.callback=s),this.x0=t.x,this.y0=t.y;var r=Math.pow(Math.pow(i-t.y,2)+Math.pow(n-t.x,2),.5);null!==o&&(this.duration=r/o),this.mx=(n-t.x)/this.duration,this.my=(i-t.y)/this.duration,e.__super__.constructor.call(this,t)}return t.extend(e),e.prototype.name="Tween",e.prototype.x=null,e.prototype.y=null,e.prototype.callback=null,e.prototype.x0=null,e.prototype.y0=null,e.prototype.time=0,e.prototype.duration=null,e.prototype.mx=null,e.prototype.my=null,e.prototype.preRender=function(t){null!==this.time&&this.time<this.duration&&(this.time+=t.dt,this.time>=this.duration?(this.entity.x=this.x,this.entity.y=this.y,this.time=null,null!==this.callback&&this.callback(t,this.entity)):(this.entity.x=this.x0+this.mx*this.time,this.entity.y=this.y0+this.my*this.time))},e}()}),n("draggable",["scene","component"],function(t,e){return function(){function n(t){n.__super__.constructor.call(this,t)}return e.extend(n),n.prototype.name="Draggable",n.prototype.draggingX=null,n.prototype.draggingY=null,n.prototype.mousedown=function(t,e){this.dragStart(t,e)},n.prototype.touchstart=function(t,e){this.dragStart(t,e)},n.prototype.mousemove=function(t,e){this.dragMove(t,e)},n.prototype.touchmove=function(t,e){this.dragMove(t,e)},n.prototype.mouseup=function(t,e){this.dragEnd(t,e)},n.prototype.touchend=function(t,e){this.dragEnd(t,e)},n.prototype.dragStart=function(e,n){if(n.dragging===!1){var i=n.getEventCoords(e);t.isInside(i,this.entity)&&(n.dragging=!0,this.draggingX=i.x-this.entity.x,this.draggingY=i.y-this.entity.y)}},n.prototype.dragMove=function(t,e){if(null!==this.draggingX&&null!==this.draggingY){var n=e.getEventCoords(t);this.entity.x=n.x-this.draggingX,this.entity.y=n.y-this.draggingY}},n.prototype.dragEnd=function(t,e){if(null!==this.draggingX&&null!==this.draggingY){e.dragging=!1;var n=e.getEventCoords(t);this.entity.x=n.x-this.draggingX,this.entity.y=n.y-this.draggingY,this.draggingX=null,this.draggingY=null}},n}()}),n("dragCreate",["scene","component"],function(t,e){return function(){function n(t,e,i){this.EntityDragBind=e,"undefined"!=typeof i&&(this.callback=i),n.__super__.constructor.call(this,t)}return e.extend(n),n.prototype.name="DragCreate",n.prototype.EntityDragBind=null,n.prototype.callback=null,n.prototype.touchstart=function(t,e){this.drag(t,e)},n.prototype.mousedown=function(t,e){this.drag(t,e)},n.prototype.drag=function(e,n){if(this.entity.display&&!n.dragging){var i=n.getEventCoords(e);if(t.isInside(i,this.entity)){var o=n.entityAdd(new this.EntityDragBind);o.x=this.entity.x,o.y=this.entity.y,o.components.Draggable.draggingX=i.x-this.entity.x,o.components.Draggable.draggingY=i.y-this.entity.y,null!==this.callback&&this.callback(e,n,this.entity,o)}}},n}()}),n("keyMove",["scene","component"],function(t,e){return function(){function t(e,n){t.__super__.constructor.call(this,e),"undefined"!=typeof n&&null!==n&&(this.speed=n)}return e.extend(t),t.prototype.name="KeyMove",t.prototype.speed=100,t.prototype.up=!1,t.prototype.down=!1,t.prototype.left=!1,t.prototype.right=!1,t.prototype.keydown=function(t){this.setKey(t.which,!0)},t.prototype.keyup=function(t){this.setKey(t.which,!1)},t.prototype.preRender=function(t){this.up&&(this.entity.y-=this.speed*t.dt),this.down&&(this.entity.y+=this.speed*t.dt),this.left&&(this.entity.x-=this.speed*t.dt),this.right&&(this.entity.x+=this.speed*t.dt)},t.prototype.setKey=function(t,e){(38===t||87===t)&&(this.up=e),(40===t||83===t)&&(this.down=e),(37===t||65===t)&&(this.left=e),(39===t||68===t)&&(this.right=e)},t}()}),n("bounded",["component"],function(t){return function(){function e(t,n,i,o,s){null!==n&&(this.x=n),null!==i&&(this.y=i),null!==o&&(this.width=o),null!==s&&(this.height=s),e.__super__.constructor.call(this,t)}return t.extend(e),e.prototype.name="Bounded",e.prototype.x=null,e.prototype.y=null,e.prototype.width=null,e.prototype.height=null,e.prototype.preRender=function(t,e){null===this.x&&(this.x=0),null===this.y&&(this.y=0),null===this.width&&(this.width=e.ctx.canvas.width),null===this.height&&(this.height=e.ctx.canvas.height),this.entity.y<this.y&&(this.entity.y=this.y),this.entity.x+this.entity.width>this.x+this.width&&(this.entity.x=this.x+this.width-this.entity.width),this.entity.y+this.entity.height>this.y+this.height&&(this.entity.y=this.height-this.y-this.entity.height),this.entity.x<this.x&&(this.entity.x=this.x)},e}()}),n("collision",["scene","component"],function(t,e){return function(){function n(t,e,i,o){this.entity=t,this.componentCollidable=e,this.callback=i,null!==o&&(this.eventName=o),n.__super__.constructor.call(this,t)}return e.extend(n),n.prototype.name="Collision",n.prototype.callback=null,n.prototype.eventName="preRender",n.prototype.componentCollidable=null,n.prototype.preRender=function(t,e){this.eventName===t.type&&this.check(t,e)},n.prototype.mouseup=function(t,e){this.eventName===t.type&&this.check(t,e)},n.prototype.mousedown=function(t,e){this.eventName===t.type&&this.check(t,e)},n.prototype.mousemove=function(t,e){this.eventName===t.type&&this.check(t,e)},n.prototype.check=function(e,n){if(this.entity.display)for(var i in n.entities){var o=n.entities[i];this.entity!==o&&o.display&&(null===this.componentCollidable||this.componentCollidable in o.components)&&t.isOverlap(this.entity,o)&&this.callback(e,n,o)}},n}()}),n("loading",["scene","text"],function(t,e){return function(){function n(t,i,o){o&&(this.sceneNameChangeTo=o),n.__super__.constructor.call(this,t),i||(i=[]),this.urlCount=i.length,this.entityAdd(new e(this.engine.ctx.canvas.width/4,260,0,"Loading...","50px 'Press Start 2P'","rgb(0, 0, 0)"));var s=this;i.forEach(function(t){var e=new Image;e.addEventListener("load",function(){s.urlsDone++},!1),e.src=t})}return t.extend(n),n.prototype.name="Loading",n.prototype.sceneNameChangeTo="Start",n.prototype.urlCount=0,n.prototype.urlsDone=0,n.prototype.render=function(t,e){this.urlsDone>=this.urlCount&&this.engine.changeScenes(this.sceneNameChangeTo),t.fillStyle="rgb(255, 255, 255)",t.fillRect(0,0,t.canvas.width,t.canvas.height),n.__super__.render.call(this,t,e)},n}()}),e.config({paths:{loading:"scenes/loading",sprite:"entities/sprite",text:"entities/text",textMultiline:"entities/textMultiline",button:"entities/button",tween:"components/tween",draggable:"components/draggable",dragCreate:"components/dragCreate",keyMove:"components/keyMove",bounded:"components/bounded",collision:"components/collision"}}),e(["engine","entity","sprite","text","textMultiline","button","component","tween","draggable","dragCreate","keyMove","bounded","collision","scene","loading"],function(t,e,n,i,o,s,r,h,p,c,l,u,a,y,d){window.hoopty={Engine:t,entities:{Entity:e,Sprite:n,Text:i,TextMultiline:o,Button:s},components:{Component:r,Bounded:u,Collision:a,Draggable:p,DragCreate:c,KeyMove:l,Tween:h},scenes:{Scene:y,Loading:d}}}),n("main",function(){}),e("main")});